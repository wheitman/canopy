import{d as Z}from"../chunks/index.R8ovVqwX.js";import{s as ee,e as M,a as O,u as te,c as y,f as k,g as j,b as N,l as C,h as I,i as P,o as ne,k as le,v as oe,w as Q,n as J,t as se,d as re,j as ae,x as ie}from"../chunks/scheduler.Dej_xGUE.js";import{S as fe,i as ce,a as _,t as w,c as G,b as R,d as V,m as D,e as B,g as z}from"../chunks/index.LdiSmlfv.js";import{g as de}from"../chunks/globals.D0QH3NT1.js";import{w as ue}from"../chunks/index.CPVvujse.js";import{c as me}from"../chunks/stores.C8XAdwxS.js";import"../chunks/create.BEvfffAz.js";import{I as pe}from"../chunks/Icon.ANQqU6E4.js";import{F as ge,a as F}from"../chunks/forest_generator.BcUdxKiQ.js";import"../chunks/paths.i9bIx48T.js";import{O as _e}from"../chunks/OsmMap.B10l6omv.js";import{S as A}from"../chunks/SpeechBubble.BSbF4gxF.js";const he=Z,be=!0,Re=Object.freeze(Object.defineProperty({__proto__:null,csr:he,prerender:be},Symbol.toStringTag,{value:"Module"})),{document:q}=de;function U(r){let e,t,n="Start",l,s;return{c(){e=M("div"),t=M("button"),t.textContent=n,this.h()},l(b){e=y(b,"DIV",{class:!0});var o=N(e);t=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(t)!=="svelte-16a4q8"&&(t.textContent=n),o.forEach(k),this.h()},h(){C(t,"class","text-lg border-4 rounded-3xl border-spring-400 bg-spring-400 transition-all p-2 font-medium flex flex-row items-center justify-center text-white"),C(e,"class","flex flex-row justify-center gap-4")},m(b,o){P(b,e,o),I(e,t),l||(s=Q(t,"click",r[8]),l=!0)},p:J,d(b){b&&k(e),l=!1,s()}}}function x(r){let e,t;return e=new A({props:{text:"Now let me calculate the best placement of each seedling...",file:"now_let_me"}}),e.$on("doneSpeaking",r[9]),{c(){R(e.$$.fragment)},l(n){V(e.$$.fragment,n)},m(n,l){D(e,n,l),t=!0},p:J,i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){B(e,n)}}}function H(r){let e,t;return e=new A({props:{character:"loading",text:"Generating plan",file:"loading"}}),e.$on("doneSpeaking",r[10]),{c(){R(e.$$.fragment)},l(n){V(e.$$.fragment,n)},m(n,l){D(e,n,l),t=!0},p:J,i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){B(e,n)}}}function Y(r){let e,t,n,l,s,b={};return t=new _e({props:b}),r[11](t),l=new A({props:{text:"All done. Here is the planting plan that I've designed. Shall I send this to Steward?",file:"all_done_here"}}),l.$on("doneSpeaking",r[12]),{c(){e=M("div"),R(t.$$.fragment),n=O(),R(l.$$.fragment),this.h()},l(o){e=y(o,"DIV",{class:!0});var S=N(e);V(t.$$.fragment,S),S.forEach(k),n=j(o),V(l.$$.fragment,o),this.h()},h(){C(e,"class","rounded-2xl h-[36rem]")},m(o,S){P(o,e,S),D(t,e,null),P(o,n,S),D(l,o,S),s=!0},p(o,S){const T={};t.$set(T)},i(o){s||(_(t.$$.fragment,o),_(l.$$.fragment,o),s=!0)},o(o){w(t.$$.fragment,o),w(l.$$.fragment,o),s=!1},d(o){o&&(k(e),k(n)),r[11](null),B(t),B(l,o)}}}function L(r){let e,t,n,l,s,b,o,S,T;return n=new pe({props:{id:"send",color:"#5b916f",size:"1.5rem"}}),{c(){e=M("div"),t=M("button"),R(n.$$.fragment),l=O(),s=se(r[0]),this.h()},l(h){e=y(h,"DIV",{class:!0});var p=N(e);t=y(p,"BUTTON",{class:!0});var E=N(t);V(n.$$.fragment,E),l=j(E),s=re(E,r[0]),E.forEach(k),p.forEach(k),this.h()},h(){C(t,"class","text-lg border-4 rounded-3xl hover:border-spring-400 transition-all p-2 border-dashed font-medium flex flex-row items-center justify-center text-spring-400"),t.disabled=b=r[0]=="Plan sent!",C(e,"class","flex flex-row justify-end gap-4")},m(h,p){P(h,e,p),I(e,t),D(n,t,null),I(t,l),I(t,s),o=!0,S||(T=Q(t,"click",r[7]),S=!0)},p(h,p){(!o||p[0]&1)&&ae(s,h[0]),(!o||p[0]&1&&b!==(b=h[0]=="Plan sent!"))&&(t.disabled=b)},i(h){o||(_(n.$$.fragment,h),o=!0)},o(h){w(n.$$.fragment,h),o=!1},d(h){h&&k(e),B(n),S=!1,T()}}}function K(r){let e,t;return e=new A({props:{text:"Steward has received the plan. Now it's time to plant our seedlings. Tap the 'Control' tab on the left to continue.",file:"steward_has_received"}}),e.$on("doneSpeaking",Se),{c(){R(e.$$.fragment)},l(n){V(e.$$.fragment,n)},m(n,l){D(e,n,l),t=!0},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){B(e,n)}}}function $e(r){let e,t,n,l,s,b,o,S,T,h,p,E,$=r[2]==0&&U(r),i=r[2]>=36&&x(r),c=r[2]==37&&H(r),d=r[2]>=38&&Y(r),u=r[2]>=40&&L(r),g=r[2]>=44&&K();return{c(){e=M("meta"),t=O(),n=M("div"),l=M("div"),$&&$.c(),s=O(),i&&i.c(),b=O(),c&&c.c(),o=O(),d&&d.c(),S=O(),u&&u.c(),T=O(),g&&g.c(),h=O(),p=M("div"),this.h()},l(a){const v=te("svelte-1fo5sqm",q.head);e=y(v,"META",{name:!0,content:!0}),v.forEach(k),t=j(a),n=y(a,"DIV",{class:!0});var f=N(n);l=y(f,"DIV",{class:!0});var m=N(l);$&&$.l(m),s=j(m),i&&i.l(m),b=j(m),c&&c.l(m),o=j(m),d&&d.l(m),S=j(m),u&&u.l(m),T=j(m),g&&g.l(m),h=j(m),p=y(m,"DIV",{id:!0}),N(p).forEach(k),m.forEach(k),f.forEach(k),this.h()},h(){q.title="Steward | Canopy",C(e,"name","description"),C(e,"content","Control and observe the robot"),C(p,"id","scroll-anchor"),C(l,"class","size-full overflow-y-auto max-w-[40rem] mx-auto px-4 py-4"),C(n,"class","size-full")},m(a,v){I(q.head,e),P(a,t,v),P(a,n,v),I(n,l),$&&$.m(l,null),I(l,s),i&&i.m(l,null),I(l,b),c&&c.m(l,null),I(l,o),d&&d.m(l,null),I(l,S),u&&u.m(l,null),I(l,T),g&&g.m(l,null),I(l,h),I(l,p),E=!0},p(a,v){a[2]==0?$?$.p(a,v):($=U(a),$.c(),$.m(l,s)):$&&($.d(1),$=null),a[2]>=36?i?(i.p(a,v),v[0]&4&&_(i,1)):(i=x(a),i.c(),_(i,1),i.m(l,b)):i&&(z(),w(i,1,1,()=>{i=null}),G()),a[2]==37?c?(c.p(a,v),v[0]&4&&_(c,1)):(c=H(a),c.c(),_(c,1),c.m(l,o)):c&&(z(),w(c,1,1,()=>{c=null}),G()),a[2]>=38?d?(d.p(a,v),v[0]&4&&_(d,1)):(d=Y(a),d.c(),_(d,1),d.m(l,S)):d&&(z(),w(d,1,1,()=>{d=null}),G()),a[2]>=40?u?(u.p(a,v),v[0]&4&&_(u,1)):(u=L(a),u.c(),_(u,1),u.m(l,T)):u&&(z(),w(u,1,1,()=>{u=null}),G()),a[2]>=44?g?v[0]&4&&_(g,1):(g=K(),g.c(),_(g,1),g.m(l,h)):g&&(z(),w(g,1,1,()=>{g=null}),G())},i(a){E||(_(i),_(c),_(d),_(u),_(g),E=!0)},o(a){w(i),w(c),w(d),w(u),w(g),E=!1},d(a){a&&(k(t),k(n)),k(e),$&&$.d(),i&&i.d(),c&&c.d(),d&&d.d(),u&&u.d(),g&&g.d()}}}const Se=()=>{};function ve(r,e,t){let n;function l(){console.log(s.locations),T(),S(),p.clearSeedlingMarkers();for(let[f,m]of s.locations)p.addSeedlingMarker(f,m)}let s=new ge(l),b=s.getRecommendedSpecies(!1,!1);s.getIncludedSpeciesCount(),s.getIncludedSpeciesCount(F.OVERSTORY),s.getIncludedSpeciesCount(F.UNDERSTORY),s.getIncludedSpeciesCount(F.EMERGENT);let o="Send to Steward";function S(){let f=s.toRos();me.set(f)}function T(){let f=s.toString();localStorage.setItem("plan",JSON.stringify(f)),console.log(`Autosaved: ${f.slice(0,100)}...`)}function h(){let f=localStorage.getItem("plan");console.log(f),setTimeout(()=>{s.loadFromString(f);let m=JSON.parse(JSON.parse(f));p.setGeometry(m.geojson),console.log(`Set geometry from ${m.geojson}`);for(let[W,X]of s.locations)p.addSeedlingMarker(W,X),console.log("Added seedling marker!")},500)}ne(()=>{});let p,E=ue([]);le(r,E,f=>t(21,n=f)),b.forEach(f=>{n.push(f.included),f.included});let $=0;function i(f){t(2,$=f),setTimeout(()=>{var m;(m=document.getElementById("scroll-anchor"))==null||m.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}),console.log("Scrolling into view")},200)}function c(){t(0,o="Sending..."),setTimeout(()=>{t(0,o="Plan sent!");var f=new Howl({volume:.5,rate:1,src:["speech/druid/collections_open.wav"],onend(){i(44)}});f.play()},700)}const d=()=>{i(36)},u=()=>{i(37)},g=()=>{i(38),h()};function a(f){ie[f?"unshift":"push"](()=>{p=f,t(1,p)})}return[o,p,$,s,h,E,i,c,d,u,g,a,()=>{i(40),console.log(s.getIncludedSpecies())}]}class Ve extends fe{constructor(e){super(),ce(this,e,ve,$e,ee,{},null,[-1,-1])}}export{Ve as component,Re as universal};
